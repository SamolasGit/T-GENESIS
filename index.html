<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T-Genesis v2 - Catálogo de Observações</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <aside id="ui">
      <div class="brand">
        <svg class="logo-icon" viewBox="0 0 256 256">
          <circle
            cx="64"
            cy="64"
            r="24"
            fill="none"
            stroke="currentColor"
            stroke-width="16"
          />
          <circle
            cx="128"
            cy="64"
            r="24"
            fill="none"
            stroke="currentColor"
            stroke-width="16"
          />
          <circle
            cx="192"
            cy="64"
            r="24"
            fill="none"
            stroke="currentColor"
            stroke-width="16"
          />

          <line
            x1="88"
            y1="64"
            x2="104"
            y2="64"
            stroke="currentColor"
            stroke-width="16"
          />
          <line
            x1="152"
            y1="64"
            x2="168"
            y2="64"
            stroke="currentColor"
            stroke-width="16"
          />

          <circle
            cx="128"
            cy="128"
            r="24"
            fill="none"
            stroke="currentColor"
            stroke-width="16"
          />
          <circle
            cx="128"
            cy="192"
            r="24"
            fill="none"
            stroke="currentColor"
            stroke-width="16"
          />

          <line
            x1="128"
            y1="88"
            x2="128"
            y2="104"
            stroke="currentColor"
            stroke-width="16"
          />
          <line
            x1="128"
            y1="152"
            x2="128"
            y2="168"
            stroke="currentColor"
            stroke-width="16"
          />
        </svg>

        <div class="brand-text">
          <span class="brand-name">T-Genesis</span>
          <span class="brand-version">Simulação Reativa</span>
        </div>
      </div>

      <section class="main-buttons">
        <button id="reset">
          <i class="ph ph-arrows-clockwise"></i>
          Resetar Mundo
        </button>

        <button id="randomize">
          <i class="ph ph-intersect"></i>
          Random Afinidade
        </button>

        <button id="randomizeReact">
          <i class="ph ph-flask"></i>
          Random Reações
        </button>
      </section>

      <div class="control-group">
        <label>Gerenciar Regras</label>
        <p class="rules-info">
          <i class="ph ph-info"></i>
          Salva: afinidades, reações e parâmetros de simulação
        </p>
        <div class="rules-management">
          <button id="saveRules" class="rules-btn save">
            <i class="ph ph-floppy-disk"></i>
            Salvar Regras
          </button>
          <button id="loadRules" class="rules-btn load">
            <i class="ph ph-upload"></i>
            Carregar Regras
          </button>
          <input
            type="file"
            id="rulesFileInput"
            accept=".json"
            style="display: none"
          />
        </div>
      </div>

      <div class="control-group">
        <label>Ferramentas de Edição</label>
        <div class="tool-buttons">
          <button id="addMode" class="tool-btn active">
            <i class="ph ph-plus-circle"></i>
            Adicionar
          </button>
          <button id="removeMode" class="tool-btn">
            <i class="ph ph-minus-circle"></i>
            Remover
          </button>
        </div>

        <div id="speciesSelector" class="species-selector-container">
          <label style="margin-top: 12px">Selecionar Espécie</label>
          <div class="particle-selector"></div>
        </div>

        <label style="margin-top: 12px">
          Tamanho Pincel <span id="brushSizeVal">5</span>
        </label>
        <input
          type="range"
          id="brushSizeInput"
          min="1"
          max="50"
          step="1"
          value="5"
        />

        <div class="toggle-container">
          <label>
            <input type="checkbox" id="showBorder" checked />
            <span>Mostrar Borda do Mundo</span>
          </label>
        </div>
      </div>

      <div class="control-group">
        <label>Espécies <span id="mVal">6</span></label>
        <input type="range" id="mInput" min="2" max="12" step="1" value="6" />

        <label>População <span id="nVal">10000</span></label>
        <input
          type="range"
          id="nInput"
          min="1000"
          max="40000"
          step="1000"
          value="10000"
        />
      </div>

      <div class="control-group">
        <label>Velocidade <span id="dtVal">0.005</span></label>
        <input
          type="range"
          id="dtInput"
          min="0"
          max="0.01"
          step="0.0000000001"
          value="0.009"
        />

        <label>Atrito <span id="frictionVal">0.05</span></label>
        <input
          type="range"
          id="frictionInput"
          min="0.01"
          max="0.5"
          step="0.01"
          value="0.46"
        />

        <label>Força (Beta) <span id="betaVal">0.020</span></label>
        <input
          type="range"
          id="betaInput"
          min="0.005"
          max="0.1"
          step="0.005"
          value="0.09"
        />
      </div>

      <div class="control-group">
        <label>Mundo <span id="worldSizeVal">2000</span></label>
        <input
          type="range"
          id="worldSizeInput"
          min="500"
          max="4000"
          step="100"
          value="2000"
        />

        <label>
          Raio Min/Max
          <span id="rMinVal">15</span> /
          <span id="rMaxVal">80</span>
        </label>
        <input type="range" id="rMinInput" min="2" max="100" value="50" />
        <input type="range" id="rMaxInput" min="50" max="250" value="200" />
      </div>

      <div class="control-group">
        <label>Prob. Reação <span id="reactVal">1.0</span>%</label>
        <input
          type="range"
          id="reactInput"
          min="0"
          max="10"
          step="0.1"
          value="1"
        />

        <label>Tam. Partícula <span id="pSizeVal">2.5</span></label>
        <input
          type="range"
          id="pSizeInput"
          min="0.1"
          max="10"
          step="0.1"
          value="2.5"
        />
      </div>

      <nav class="tabs">
        <button class="tab-btn active" data-tab="tab-aff">Afinidades</button>
        <button class="tab-btn" data-tab="tab-regras">Reações</button>
        <button class="tab-btn" data-tab="tab-catalog">
          <i class="ph ph-notebook"></i>
          Catálogo
        </button>
      </nav>

      <div id="tab-aff" class="tab-content active">
        <div id="matrix" class="matrix"></div>
      </div>

      <div id="tab-regras" class="tab-content">
        <div class="reaction-builder">
          <div class="color-row">
            <div
              id="pickA"
              class="color-pick"
              data-val="0"
              style="background: #ff4757"
            ></div>
            <span class="symbol">+</span>
            <div
              id="pickB"
              class="color-pick"
              data-val="1"
              style="background: #6c5ce7"
            ></div>
            <span class="symbol">→</span>
            <div
              id="pickC"
              class="color-pick"
              data-val="2"
              style="background: #00f2ff"
            ></div>
            <span class="symbol">+</span>
            <div
              id="pickD"
              class="color-pick"
              data-val="0"
              style="background: #ff4757"
            ></div>
          </div>

          <button id="addRuleBtn" class="secondary-btn">
            <i class="ph ph-plus"></i>
            Adicionar Regra
          </button>
        </div>

        <div id="activeRulesList"></div>
      </div>

      <div id="tab-catalog" class="tab-content">
        <div class="catalog-header">
          <h3>
            <i class="ph ph-notebook"></i>
            Catálogo de Observações
          </h3>
          <p class="catalog-subtitle">
            Capture e documente formações celulares interessantes
          </p>
        </div>

        <div class="catalog-actions">
          <button id="captureBtn" class="catalog-btn capture">
            <i class="ph ph-camera"></i>
            Capturar Observação
          </button>
          <button id="exportCatalog" class="catalog-btn export">
            <i class="ph ph-download-simple"></i>
            Exportar Catálogo
          </button>
          <button id="importCatalog" class="catalog-btn import">
            <i class="ph ph-upload-simple"></i>
            Importar Catálogo
          </button>
          <input
            type="file"
            id="catalogFileInput"
            accept=".json"
            style="display: none"
          />
        </div>

        <div id="catalogGrid" class="catalog-grid"></div>
      </div>
    </aside>

    <main>
      <canvas id="c"></canvas>

      <!-- Capture overlay -->
      <div id="captureOverlay" class="capture-overlay">
        <div id="captureSelection" class="capture-selection">
          <div class="capture-corners">
            <div class="capture-corner tl"></div>
            <div class="capture-corner tr"></div>
            <div class="capture-corner bl"></div>
            <div class="capture-corner br"></div>
          </div>
        </div>
      </div>

      <div id="captureHint" class="capture-hint">
        <i class="ph ph-camera"></i>
        <span>Clique e arraste para selecionar a área • ESC para cancelar</span>
      </div>
    </main>

    <!-- Observation Modal -->
    <div id="observationModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>
            <i class="ph ph-clipboard-text"></i>
            Nova Observação
          </h3>
          <button id="closeModal" class="close-btn">
            <i class="ph ph-x"></i>
          </button>
        </div>

        <div class="modal-body">
          <canvas id="previewCanvas"></canvas>

          <div class="form-group">
            <label for="observationName">Nome da Célula/Organismo</label>
            <input
              type="text"
              id="observationName"
              placeholder="Ex: Célula Espiral Azul"
              maxlength="50"
            />
          </div>

          <div class="form-group">
            <label for="observationDesc">Descrição e Notas</label>
            <textarea
              id="observationDesc"
              placeholder="Descreva o comportamento, padrões de movimento, interações observadas..."
              rows="4"
              maxlength="500"
            ></textarea>
          </div>

          <div class="observation-metadata">
            <div class="metadata-item">
              <i class="ph ph-users"></i>
              <span id="metaPopulation">N/A</span> partículas
            </div>
            <div class="metadata-item">
              <i class="ph ph-palette"></i>
              <span id="metaSpecies">N/A</span> espécies
            </div>
            <div class="metadata-item">
              <i class="ph ph-calendar"></i>
              <span id="metaDate">N/A</span>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button id="cancelObservation" class="modal-btn cancel">
            Cancelar
          </button>
          <button id="saveObservation" class="modal-btn save">
            <i class="ph ph-check"></i>
            Salvar Observação
          </button>
        </div>
      </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal">
      <div class="modal-content detail-modal">
        <div class="modal-header">
          <h3 id="detailName">Observação</h3>
          <button id="closeDetailModal" class="close-btn">
            <i class="ph ph-x"></i>
          </button>
        </div>

        <div class="modal-body detail-body">
          <img id="detailImage" alt="Observação" />

          <div class="detail-info">
            <h4>Descrição</h4>
            <p id="detailDesc"></p>

            <h4>Metadados</h4>
            <div class="observation-metadata">
              <div class="metadata-item">
                <i class="ph ph-users"></i>
                <span id="detailPopulation">N/A</span> partículas
              </div>
              <div class="metadata-item">
                <i class="ph ph-palette"></i>
                <span id="detailSpecies">N/A</span> espécies
              </div>
              <div class="metadata-item">
                <i class="ph ph-calendar"></i>
                <span id="detailDate">N/A</span>
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button id="loadObservationRules" class="modal-btn load-rules">
            <i class="ph ph-play"></i>
            Carregar Regras
          </button>
          <button id="deleteObservation" class="modal-btn delete">
            <i class="ph ph-trash"></i>
            Excluir
          </button>
          <button id="closeDetail" class="modal-btn">Fechar</button>
        </div>
      </div>
    </div>

    <script src="main.js"></script>
  </body>
</html>
